<style>
  /* Bingkai Utama */
  #random-post-daily {
    display: none;
    margin: 20px 0;
    padding: 15px;
    background: var(--content-bg);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    position: relative;
    box-shadow: 0 4px 12px rgba(0,0,0,0.03);
    animation: fadeInUp 0.6s ease-out forwards;
  }

  /* Ornamen Sudut */
  .rp-ornament {
    position: absolute;
    width: 45px;
    height: 45px;
    fill: #8875F5;
    z-index: 2;
    pointer-events: none;
    opacity: 0.8;
  }
  .orn-tl { top: -1px; left: -1px; }
  .orn-br { bottom: -1px; right: -1px; transform: rotate(180deg); }

  /* Garis Tipis Interior */
  #random-post-daily::before {
    content: '';
    position: absolute;
    top: 6px; left: 6px; right: 6px; bottom: 6px;
    border: 1px solid #8875F5;
    opacity: 0.15;
    pointer-events: none;
    border-radius: 6px;
  }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .rp-inner { position: relative; z-index: 3; }
  .rp-header {
    font-size: 10.5px;
    font-weight: 700;
    color: #8875F5;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    text-align: center;
    margin-bottom: 12px;
  }

  #rp-content { display: flex; gap: 15px; text-decoration: none; align-items: center; }
  
  .rp-img-frame {
    width: 70px;
    height: 70px;
    border-radius: 8px;
    overflow: hidden;
    flex-shrink: 0;
    background: #8875F5;
    border: 1px solid var(--border-color);
  }

  #rp-image { width: 100%; height: 100%; object-fit: cover; }
  
  .rp-info { flex: 1; min-width: 0; }
  #rp-title {
    font-size: 15px;
    font-weight: 600;
    line-height: 1.4;
    margin: 0 0 4px 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    color: var(--text-color);
  }
  #rp-content:hover #rp-title { color: #8875F5; }
  #rp-date { font-size: 11px; color: var(--text-color); opacity: 0.5; }
</style>

<div id="random-post-daily">
  <svg class="rp-ornament orn-tl" viewbox="0 0 100 100"><path d="M0 0v100c0-55.2 44.8-100 100-100H0zm20 20c0 33.1 26.9 60 60 60V20H20z" opacity=".2"/><path d="M5 5v40c0-19.3 15.7-35 35-35H5zm10 10c0 11 9 20 20 20V15H15z"/></path></path></svg>
  <svg class="rp-ornament orn-br" viewbox="0 0 100 100"><path d="M0 0v100c0-55.2 44.8-100 100-100H0zm20 20c0 33.1 26.9 60 60 60V20H20z" opacity=".2"/><path d="M5 5v40c0-19.3 15.7-35 35-35H5zm10 10c0 11 9 20 20 20V15H15z"/></path></path></svg>
  
  <div class="rp-inner">
    <div class="rp-header">Postingan Pilihan</div>
    <a id="rp-content" href="#">
      <div class="rp-img-frame">
        <img id="rp-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Thumbnail" />
      </div>
      <div class="rp-info">
        <h3 id="rp-title">Memuat arsip...</h3>
        <span id="rp-date"></span>
      </div>
    </a>
  </div>
</div>

<script>
(function() {
  const isHomepage = window.location.pathname === '/' || window.location.pathname === '/index.html' || window.location.pathname === '';
  if (!isHomepage) return;

  const API_KEY = 'AIzaSyDPliBpzAnGEJhxNuhVdHIG7iri3ga4_0E';
  const BLOG_ID = '5360007822337580481';

  function getImg(post) {
    let src = 'https://placehold.co/200x200/8875F5/ffffff?text=Arsip';
    if (post.images && post.images.length > 0) {
      src = post.images[0].url;
    } else {
      const match = /<img.*?src=["'](.*?)["']/.exec(post.content);
      if (match && match[1]) src = match[1];
    }
    return src.replace(/\/s\d+(-c)?\//, '/s200/').replace(/=s\d+(-c)?/, '=s200');
  }

  async function fetchArchive() {
    try {
      // Rentang waktu aman: 2012 - 2026
      const start = new Date('2012-01-01T00:00:00Z').getTime();
      const end = new Date('2026-12-31T23:59:59Z').getTime();
      const randomTime = start + (Math.random() * (end - start));
      const rDate = new Date(randomTime).toISOString();

      const url = `https://www.googleapis.com/blogger/v3/blogs/${BLOG_ID}/posts?key=${API_KEY}&maxResults=50&publishedBefore=${rDate}&fields=items(title,url,published,images,content)`;
      
      const res = await fetch(url);
      const data = await res.json();

      let post;
      if (data.items && data.items.length > 0) {
        post = data.items[Math.floor(Math.random() * data.items.length)];
      } else {
        // Fallback ke 2026 jika pencarian random kosong
        const fbUrl = `https://www.googleapis.com/blogger/v3/blogs/${BLOG_ID}/posts?key=${API_KEY}&maxResults=10&publishedBefore=2026-12-31T23:59:59Z`;
        const fbRes = await fetch(fbUrl);
        const fbData = await fbRes.json();
        post = fbData.items[Math.floor(Math.random() * fbData.items.length)];
      }

      if (post) {
        document.getElementById('rp-title').innerText = post.title;
        document.getElementById('rp-content').href = post.url;
        document.getElementById('rp-date').innerText = new Date(post.published).toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });
        document.getElementById('rp-image').src = getImg(post);
        document.getElementById('random-post-daily').style.display = 'block';
      }
    } catch (e) {
      console.error("Widget Error:", e);
    }
  }

  fetchArchive();
})();
</script>
